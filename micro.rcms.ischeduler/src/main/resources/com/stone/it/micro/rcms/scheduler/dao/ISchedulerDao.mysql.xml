<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.stone.it.micro.rcms.scheduler.dao.ISchedulerDao">
  <delete id="deleteQuartz"></delete>
  <insert id="createQuartz"></insert>
  <insert id="createJob">
    INSERT INTO tpl_quartz_job_t
    ( quartz_id, job_id, job_status, start_time )
    VALUES
    (#{quartzId},#{jobId},#{jobStatus},#{startTime})
  </insert>
  <select id="findQuartzList"
    resultType="com.stone.it.micro.rcms.scheduler.vo.SchedulerVO">
    <include refid="query_base_sql"></include>
    where enabled_flag = #{enabledFlag}
  </select>
  <select id="findQuartzPageResult"
    resultType="com.stone.it.micro.rcms.scheduler.vo.SchedulerVO"></select>

  <select id="findQuartzPageResultCount"
    resultType="integer"></select>

  <select id="findQuartzInfo"
    resultType="com.stone.it.micro.rcms.scheduler.vo.SchedulerVO"></select>
  <select id="findQuartzJobPageResult"
          resultType="com.stone.it.micro.rcms.scheduler.vo.QuartzJobVO"></select>
  <sql id="query_base_sql">
    SELECT
    quartz_id as quartzId,
    quartz_name as quartzName,
    quartz_group as quartzGroup,
    quartz_desc as quartzDesc,
    quartz_cron as quartzCron,
    quartz_cron_zh as quartzCronZh,
    enabled_flag as enabledFlag,
    request_uri as requestPath,
    request_type as requestType
    FROM
    tpl_quartz_t
  </sql>
  <update id="updateQuartz"></update>
  <update id="updateJob">
    update tpl_quartz_job_t
    <set >
      <if test="jobStatus != null" >
        job_status = #{jobStatus,jdbcType=VARCHAR},
      </if>
      <if test="responseCode != null" >
        response_code = #{responseCode,jdbcType=VARCHAR},
      </if>
      <if test="responseBody != null" >
        response_body = #{responseBody,jdbcType=VARCHAR},
      </if>
      <if test="endTime != null" >
        end_time = #{endTime,jdbcType=TIMESTAMP},
      </if>
    </set>
    where job_id = #{jobId,jdbcType=VARCHAR}
  </update>
</mapper>