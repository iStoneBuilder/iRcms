<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.stone.it.rcms.auth.dao.IUserAuthDao">


  <select id="getUserInfoByUserId" resultType="com.stone.it.rcms.auth.vo.AuthUserVO">
    SELECT
    user_id as userId,
    user_name as userName,
    user_account as userAccount,
    password
    FROM
    tpl_user_t
    WHERE
    user_id = #{userId}
  </select>


  <select id="getUserRoleInfoByUserId" resultType="com.stone.it.rcms.auth.vo.AuthRoleVO">
    SELECT
    r.role_id as roleId,
    r.role_code as roleCode,
    r.role_name as roleName
    FROM
    tpl_role_t r
    LEFT JOIN tpl_user_role_t ur ON r.role_id = ur.role_id
    WHERE
    ur.user_id = #{userId}
  </select>


  <select id="getPermissionByRoleCodes" resultType="com.stone.it.rcms.auth.vo.PermissionVO">
    SELECT
    t1.permission_id as permissionId,
    t1.permission_code as permissionCode,
    t1.permission_path as permissionPath
    FROM
    tpl_permission_t t1
    LEFT JOIN tpl_role_permission_t t2 ON t1.permission_code = t2.permission_code
    WHERE
    t2.role_code IN
    <foreach close=")" collection="roleSets" item="roleCode" open="(" separator=",">
      #{roleCode}
    </foreach>
  </select>

  <select id="getPermissionByAccountId"
    resultType="com.stone.it.rcms.auth.vo.PermissionVO">
    select
    t1.permission_id as permissionId,
    t1.permission_code as permissionCode,
    t1.permission_name as permissionName
    from
    tpl_permission_t t1
    LEFT JOIN tpl_account_permission_t t2 ON t1.permission_code = t2.permission_code
    where
    t2.app_id = #{appId}
  </select>

</mapper>