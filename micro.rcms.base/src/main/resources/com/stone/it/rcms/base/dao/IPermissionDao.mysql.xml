<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.stone.it.rcms.base.dao.IPermissionDao">

  <sql id="query_base">
    select
    api_code as code,
    api_name as name,
    api_path as path,
    api_type as type,
    api_method as method,
    auth_code as authCode,
    open_api as isOpenApi
    from  tpl_permission_t
  </sql>
  <sql id="query_condition">
    <where>
      <if test="param1.code!= null and param1.code!= ''">
        and api_code like #{param1.code,jdbcType=VARCHAR}
      </if>
      <if test="param1.name!= null and param1.name!= ''">
        and api_name like #{param1.name,jdbcType=VARCHAR}
      </if>
      <if test="param1.path!= null and param1.path!= ''">
        and api_path like #{param1.path,jdbcType=VARCHAR}
      </if>
      <if test="param1.type!= null and param1.type!= ''">
        and api_type = #{param1.type,jdbcType=VARCHAR}
      </if>
      <if test="param1.method!= null and param1.method!= ''">
        and api_method = #{param1.method,jdbcType=VARCHAR}
      </if>
      <if test="param1.authCode!= null and param1.authCode!= ''">
        and auth_code like #{param1.authCode,jdbcType=VARCHAR}
      </if>
      <if test="param1.isOpenApi!= null and param1.isOpenApi!= ''">
        and open_api = #{param1.isOpenApi,jdbcType=VARCHAR}
      </if>
    </where>
  </sql>

  <select id="findPermissionPageResult"
    resultType="com.stone.it.rcms.base.vo.PermissionVO">
    <include refid="query_base"/>
    <include refid="query_condition"/>
    order by api_name desc,auth_code desc
    limit #{param2.startIndex}, #{param2.endIndex}
  </select>
  <select id="findPermissionPageResultCount" resultType="int">
    select count(*) from tpl_permission_t
    <include refid="query_condition"/>
  </select>

</mapper>